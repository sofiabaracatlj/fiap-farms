<!DOCTYPE html>
<html>
<head>
  <title>json5</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "node_modules/.bin/json5";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>json5</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-meta">#!/usr/bin/env node</span>

<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>)
<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)
<span class="hljs-keyword">const</span> pkg = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../package.json'</span>)
<span class="hljs-keyword">const</span> JSON5 = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./'</span>)

<span class="hljs-keyword">const</span> argv = parseArgs()

<span class="hljs-keyword">if</span> (argv.version) {
    version()
} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (argv.help) {
    usage()
} <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">const</span> inFilename = argv.defaults[<span class="hljs-number">0</span>]

    <span class="hljs-keyword">let</span> readStream
    <span class="hljs-keyword">if</span> (inFilename) {
        readStream = fs.createReadStream(inFilename)
    } <span class="hljs-keyword">else</span> {
        readStream = process.stdin
    }

    <span class="hljs-keyword">let</span> json5 = <span class="hljs-string">''</span>
    readStream.on(<span class="hljs-string">'data'</span>, data =&gt; {
        json5 += data
    })

    readStream.on(<span class="hljs-string">'end'</span>, () =&gt; {
        <span class="hljs-keyword">let</span> space
        <span class="hljs-keyword">if</span> (argv.space === <span class="hljs-string">'t'</span> || argv.space === <span class="hljs-string">'tab'</span>) {
            space = <span class="hljs-string">'\t'</span>
        } <span class="hljs-keyword">else</span> {
            space = <span class="hljs-built_in">Number</span>(argv.space)
        }

        <span class="hljs-keyword">let</span> value
        <span class="hljs-keyword">try</span> {
            value = JSON5.parse(json5)
            <span class="hljs-keyword">if</span> (!argv.validate) {
                <span class="hljs-keyword">const</span> json = <span class="hljs-built_in">JSON</span>.stringify(value, <span class="hljs-literal">null</span>, space)

                <span class="hljs-keyword">let</span> writeStream

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>--convert is for backward compatibility with v0.5.1. If
specified with <file> and not --out-file, then a file with
the same name but with a .json extension will be written.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">                <span class="hljs-keyword">if</span> (argv.convert &amp;&amp; inFilename &amp;&amp; !argv.outFile) {
                    <span class="hljs-keyword">const</span> parsedFilename = path.parse(inFilename)
                    <span class="hljs-keyword">const</span> outFilename = path.format(
                        <span class="hljs-built_in">Object</span>.assign(
                            parsedFilename,
                            {<span class="hljs-attr">base</span>: path.basename(parsedFilename.base, parsedFilename.ext) + <span class="hljs-string">'.json'</span>}
                        )
                    )

                    writeStream = fs.createWriteStream(outFilename)
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (argv.outFile) {
                    writeStream = fs.createWriteStream(argv.outFile)
                } <span class="hljs-keyword">else</span> {
                    writeStream = process.stdout
                }

                writeStream.write(json)
            }
        } <span class="hljs-keyword">catch</span> (err) {
            <span class="hljs-built_in">console</span>.error(err.message)
            process.exit(<span class="hljs-number">1</span>)
        }
    })
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parseArgs</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">let</span> convert
    <span class="hljs-keyword">let</span> space
    <span class="hljs-keyword">let</span> validate
    <span class="hljs-keyword">let</span> outFile
    <span class="hljs-keyword">let</span> version
    <span class="hljs-keyword">let</span> help
    <span class="hljs-keyword">const</span> defaults = []

    <span class="hljs-keyword">const</span> args = process.argv.slice(<span class="hljs-number">2</span>)
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; args.length; i++) {
        <span class="hljs-keyword">const</span> arg = args[i]
        <span class="hljs-keyword">switch</span> (arg) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">'--convert'</span>:
        <span class="hljs-keyword">case</span> <span class="hljs-string">'-c'</span>:
            convert = <span class="hljs-literal">true</span>
            <span class="hljs-keyword">break</span>

        <span class="hljs-keyword">case</span> <span class="hljs-string">'--space'</span>:
        <span class="hljs-keyword">case</span> <span class="hljs-string">'-s'</span>:
            space = args[++i]
            <span class="hljs-keyword">break</span>

        <span class="hljs-keyword">case</span> <span class="hljs-string">'--validate'</span>:
        <span class="hljs-keyword">case</span> <span class="hljs-string">'-v'</span>:
            validate = <span class="hljs-literal">true</span>
            <span class="hljs-keyword">break</span>

        <span class="hljs-keyword">case</span> <span class="hljs-string">'--out-file'</span>:
        <span class="hljs-keyword">case</span> <span class="hljs-string">'-o'</span>:
            outFile = args[++i]
            <span class="hljs-keyword">break</span>

        <span class="hljs-keyword">case</span> <span class="hljs-string">'--version'</span>:
        <span class="hljs-keyword">case</span> <span class="hljs-string">'-V'</span>:
            version = <span class="hljs-literal">true</span>
            <span class="hljs-keyword">break</span>

        <span class="hljs-keyword">case</span> <span class="hljs-string">'--help'</span>:
        <span class="hljs-keyword">case</span> <span class="hljs-string">'-h'</span>:
            help = <span class="hljs-literal">true</span>
            <span class="hljs-keyword">break</span>

        <span class="hljs-attr">default</span>:
            defaults.push(arg)
            <span class="hljs-keyword">break</span>
        }
    }

    <span class="hljs-keyword">return</span> {
        convert,
        space,
        validate,
        outFile,
        version,
        help,
        defaults,
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">version</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">console</span>.log(pkg.version)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">usage</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">console</span>.log(
        <span class="hljs-string">`
  Usage: json5 [options] &lt;file&gt;

  If &lt;file&gt; is not provided, then STDIN is used.

  Options:

    -s, --space              The number of spaces to indent or 't' for tabs
    -o, --out-file [file]    Output to the specified file, otherwise STDOUT
    -v, --validate           Validate JSON5 but do not output JSON
    -V, --version            Output the version number
    -h, --help               Output usage information`</span>
    )
}

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
